%Developed by Pablo Vicente-Munuera

%Algorithm hexagonal voronoi grid with sharing cells/fiber and mean area
% within the hexagon as weights
cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 1. Y01_01B16459B\CoreA\'
createNetworkContigousHexagonalGridMeanArea

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 1. Y01_01B16459B\CoreB\'
createNetworkContigousHexagonalGridMeanArea

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 2. Y02A_02B03119A\CoreA\'
createNetworkContigousHexagonalGridMeanArea

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 2. Y02A_02B03119A\CoreB\'
createNetworkContigousHexagonalGridMeanArea

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 3. Y02A_02B13320A\CoreA\'
createNetworkContigousHexagonalGridMeanArea

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 4. Y03A_03B12888B\CoreB\'
createNetworkContigousHexagonalGridMeanArea

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 5. Y03A_03B17300B\CoreA\'
createNetworkContigousHexagonalGridMeanArea

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 5. Y03A_03B17300B\CoreB\'
createNetworkContigousHexagonalGridMeanArea

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 6. Y03B_03B03346B\CoreB\'
createNetworkContigousHexagonalGridMeanArea

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 7. Y03B_03B07423A\CoreA\'
createNetworkContigousHexagonalGridMeanArea

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 7. Y03B_03B07423A\CoreB\'
createNetworkContigousHexagonalGridMeanArea

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 8. Y03B_03B08572A\CoreA\'
createNetworkContigousHexagonalGridMeanArea

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 8. Y03B_03B08572A\CoreB\'
createNetworkContigousHexagonalGridMeanArea

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 9. Y2_333688B\CoreB\'
createNetworkContigousHexagonalGridMeanArea

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 10. Y2_99B00646B\CoreB\'
createNetworkContigousHexagonalGridMeanArea

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 11. Y2_99B13169A\CoreA\'
createNetworkContigousHexagonalGridMeanArea

%-------------------------------------------

%Algorithm minimum distance between classes (NO hexagonal voronoi grid)
cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 1. Y01_01B16459B\CoreA\'
createNetworkMinimumDistance

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 1. Y01_01B16459B\CoreB\'
createNetworkMinimumDistance

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 2. Y02A_02B03119A\CoreA\'
createNetworkMinimumDistance

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 2. Y02A_02B03119A\CoreB\'
createNetworkMinimumDistance

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 3. Y02A_02B13320A\CoreA\'
createNetworkMinimumDistance

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 4. Y03A_03B12888B\CoreB\'
createNetworkMinimumDistance

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 5. Y03A_03B17300B\CoreA\'
createNetworkMinimumDistance

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 5. Y03A_03B17300B\CoreB\'
createNetworkMinimumDistance

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 6. Y03B_03B03346B\CoreB\'
createNetworkMinimumDistance

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 7. Y03B_03B07423A\CoreA\'
createNetworkMinimumDistance

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 7. Y03B_03B07423A\CoreB\'
createNetworkMinimumDistance

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 8. Y03B_03B08572A\CoreA\'
createNetworkMinimumDistance

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 8. Y03B_03B08572A\CoreB\'
createNetworkMinimumDistance

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 9. Y2_333688B\CoreB\'
createNetworkMinimumDistance

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 10. Y2_99B00646B\CoreB\'
createNetworkMinimumDistance

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 11. Y2_99B13169A\CoreA\'
createNetworkMinimumDistance

%-----------------------------------------------

%Algorithm hexagonal voronoi grid with sharing cells/fiber and mean area
% within the hexagon as weights
cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 1. Y01_01B16459B\CoreA\'
createNetworkHexagonalGridSharedSide

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 1. Y01_01B16459B\CoreB\'
createNetworkHexagonalGridSharedSide

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 2. Y02A_02B03119A\CoreA\'
createNetworkHexagonalGridSharedSide

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 2. Y02A_02B03119A\CoreB\'
createNetworkHexagonalGridSharedSide

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 3. Y02A_02B13320A\CoreA\'
createNetworkHexagonalGridSharedSide

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 4. Y03A_03B12888B\CoreB\'
createNetworkHexagonalGridSharedSide

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 5. Y03A_03B17300B\CoreA\'
createNetworkHexagonalGridSharedSide

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 5. Y03A_03B17300B\CoreB\'
createNetworkHexagonalGridSharedSide

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 6. Y03B_03B03346B\CoreB\'
createNetworkHexagonalGridSharedSide

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 7. Y03B_03B07423A\CoreA\'
createNetworkHexagonalGridSharedSide
    
cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 7. Y03B_03B07423A\CoreB\'
createNetworkHexagonalGridSharedSide

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 8. Y03B_03B08572A\CoreA\'
createNetworkHexagonalGridSharedSide

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 8. Y03B_03B08572A\CoreB\'
createNetworkHexagonalGridSharedSide

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 9. Y2_333688B\CoreB\'
createNetworkHexagonalGridSharedSide

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 10. Y2_99B00646B\CoreB\'
createNetworkHexagonalGridSharedSide

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 11. Y2_99B13169A\CoreA\'
createNetworkHexagonalGridSharedSide

%-----------------------------------------------

% %Algorithm hexagonal voronoi grid with sharing cells/fiber and mean area
% % within the hexagon as weights
% cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 1. Y01_01B16459B\CoreA\'
% createNetworkHexagonalGridMeanArea
% 
% cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 1. Y01_01B16459B\CoreB\'
% createNetworkHexagonalGridMeanArea
% 
% cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 2. Y02A_02B03119A\CoreA\'
% createNetworkHexagonalGridMeanArea
% 
% cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 2. Y02A_02B03119A\CoreB\'
% createNetworkHexagonalGridMeanArea
% 
% cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 3. Y02A_02B13320A\CoreA\'
% createNetworkHexagonalGridMeanArea
% 
% cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 4. Y03A_03B12888B\CoreB\'
% createNetworkHexagonalGridMeanArea
% 
% cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 5. Y03A_03B17300B\CoreA\'
% createNetworkHexagonalGridMeanArea
% 
% cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 5. Y03A_03B17300B\CoreB\'
% createNetworkHexagonalGridMeanArea
% 
% cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 6. Y03B_03B03346B\CoreB\'
% createNetworkHexagonalGridMeanArea
% 
% cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 7. Y03B_03B07423A\CoreA\'
% createNetworkHexagonalGridMeanArea
%     
% cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 7. Y03B_03B07423A\CoreB\'
% createNetworkHexagonalGridMeanArea
% 
% cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 8. Y03B_03B08572A\CoreA\'
% createNetworkHexagonalGridMeanArea
% 
% cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 8. Y03B_03B08572A\CoreB\'
% createNetworkHexagonalGridMeanArea
% 
% cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 9. Y2_333688B\CoreB\'
% createNetworkHexagonalGridMeanArea
% 
% cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 10. Y2_99B00646B\CoreB\'
% createNetworkHexagonalGridMeanArea
% 
% cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 11. Y2_99B13169A\CoreA\'
% createNetworkHexagonalGridMeanArea

%-----------------------------------------------

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 1. Y01_01B16459B\CoreA\adjacency\'
calculateBasicMeasuresOfAllNetworksOfDirectory

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 1. Y01_01B16459B\CoreB\adjacency\'
calculateBasicMeasuresOfAllNetworksOfDirectory

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 2. Y02A_02B03119A\CoreA\adjacency\'
calculateBasicMeasuresOfAllNetworksOfDirectory

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 2. Y02A_02B03119A\CoreB\adjacency\'
calculateBasicMeasuresOfAllNetworksOfDirectory

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 3. Y02A_02B13320A\CoreA\adjacency\'
calculateBasicMeasuresOfAllNetworksOfDirectory

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 4. Y03A_03B12888B\CoreB\adjacency\'
calculateBasicMeasuresOfAllNetworksOfDirectory

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 5. Y03A_03B17300B\CoreA\adjacency\'
calculateBasicMeasuresOfAllNetworksOfDirectory

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 5. Y03A_03B17300B\CoreB\adjacency\'
calculateBasicMeasuresOfAllNetworksOfDirectory

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 6. Y03B_03B03346B\CoreB\adjacency\'
calculateBasicMeasuresOfAllNetworksOfDirectory

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 7. Y03B_03B07423A\CoreA\adjacency\'
calculateBasicMeasuresOfAllNetworksOfDirectory
    
cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 7. Y03B_03B07423A\CoreB\adjacency\'
calculateBasicMeasuresOfAllNetworksOfDirectory

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 8. Y03B_03B08572A\CoreA\adjacency\'
calculateBasicMeasuresOfAllNetworksOfDirectory

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 8. Y03B_03B08572A\CoreB\adjacency\'
calculateBasicMeasuresOfAllNetworksOfDirectory

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 9. Y2_333688B\CoreB\adjacency\'
calculateBasicMeasuresOfAllNetworksOfDirectory

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 10. Y2_99B00646B\CoreB\adjacency\'
calculateBasicMeasuresOfAllNetworksOfDirectory

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 11. Y2_99B13169A\CoreA\adjacency\'
calculateBasicMeasuresOfAllNetworksOfDirectory

%-----------------------------------------------

cd E:\Pablo\Neuroblastoma\NeuroblastomeIntegration\ExternalTools\JavaPlex

calculatePersistentHomology('E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 1. Y01_01B16459B\CoreA\')

calculatePersistentHomology('E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 1. Y01_01B16459B\CoreB\')

calculatePersistentHomology('E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 2. Y02A_02B03119A\CoreA\')

calculatePersistentHomology('E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 2. Y02A_02B03119A\CoreB\')

calculatePersistentHomology('E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 3. Y02A_02B13320A\CoreA\')

calculatePersistentHomology('E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 4. Y03A_03B12888B\CoreB\')

calculatePersistentHomology('E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 5. Y03A_03B17300B\CoreA\')

calculatePersistentHomology('E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 5. Y03A_03B17300B\CoreB\')

calculatePersistentHomology('E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 6. Y03B_03B03346B\CoreB\')

calculatePersistentHomology('E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 7. Y03B_03B07423A\CoreA\')

calculatePersistentHomology('E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 7. Y03B_03B07423A\CoreB\')

calculatePersistentHomology('E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 8. Y03B_03B08572A\CoreA\')

calculatePersistentHomology('E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 8. Y03B_03B08572A\CoreB\')

calculatePersistentHomology('E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 9. Y2_333688B\CoreB\')

calculatePersistentHomology('E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 10. Y2_99B00646B\CoreB\')

calculatePersistentHomology('E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 11. Y2_99B13169A\CoreA\')

cd ..
cd ..

%--------------------------------
cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 1. Y01_01B16459B\CoreA\Adjacency\'
calculateLEDAFilesFromDirectory

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 1. Y01_01B16459B\CoreB\Adjacency\'
calculateLEDAFilesFromDirectory

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 2. Y02A_02B03119A\CoreA\Adjacency\'
calculateLEDAFilesFromDirectory

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 2. Y02A_02B03119A\CoreB\Adjacency\'
calculateLEDAFilesFromDirectory

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 3. Y02A_02B13320A\CoreA\Adjacency\'
calculateLEDAFilesFromDirectory

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 4. Y03A_03B12888B\CoreB\Adjacency\'
calculateLEDAFilesFromDirectory

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 5. Y03A_03B17300B\CoreA\Adjacency\'
calculateLEDAFilesFromDirectory

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 5. Y03A_03B17300B\CoreB\Adjacency\'
calculateLEDAFilesFromDirectory

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 6. Y03B_03B03346B\CoreB\Adjacency\'
calculateLEDAFilesFromDirectory

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 7. Y03B_03B07423A\CoreA\Adjacency\'
calculateLEDAFilesFromDirectory

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 7. Y03B_03B07423A\CoreB\Adjacency\'
calculateLEDAFilesFromDirectory

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 8. Y03B_03B08572A\CoreA\Adjacency\'
calculateLEDAFilesFromDirectory

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 8. Y03B_03B08572A\CoreB\Adjacency\'
calculateLEDAFilesFromDirectory

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 9. Y2_333688B\CoreB\Adjacency\'
calculateLEDAFilesFromDirectory

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 10. Y2_99B00646B\CoreB\Adjacency\'
calculateLEDAFilesFromDirectory

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 11. Y2_99B13169A\CoreA\Adjacency\'
calculateLEDAFilesFromDirectory

%-------------------------------------------
%load('E:\Pablo\Neuroblastoma\Results\graphletsCount\Casos\1\matlabGCD73.mat');
load('E:\Pablo\Neuroblastoma\Results\graphletsCount\NuevosCasos\RET\NDUMP2\matlabGCD73.mat');
load('E:\Pablo\Neuroblastoma\Results\graphletsCount\NuevosCasos\inestabilidadCasos.mat');


markersNames = {'RET', 'COL', 'GAG', 'CD31', 'CD45', 'CD4', 'CD7', 'CD8', 'CD11b', 'CD11c', 'CD20', 'CD68', 'CD163', 'OCT4', 'S100A6'};
algorithm = {'minimumDistanceClassesBetweenPairs', 'minimumDistanceClasses', 'adjacencyMatrix_hexagonalSharedSide', 'adjacencyMatrix_ContigousHexagonalMeanArea', 'centroids'};
%centroids = persistent homology
markersWeWantToShow = {'RET'}; % 'CD11b' 
algorithmWeWantToShow = {'minimumDistanceClassesBetweenPairs'};
kindsInestability = unique(estabilidad);

visualizeMarkers(distanceMatrix, names, markersNames, markersWeWantToShow, algorithm, algorithmWeWantToShow, 'GCD73', kindsInestability, NBiopsia, estabilidad);

createHeatmapFromDistanceMatrix(distanceMatrix, names, markersNames, markersWeWantToShow, algorithm, algorithmWeWantToShow, NBiopsia, estabilidad);

%------------------------------------------%


cd E:\Pablo\Neuroblastoma\NeuroblastomeIntegration\ExternalTools\JavaPlex

calculatePersistentHomologyFromIterations('E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 1. Y01_01B16459B\CoreB\Adjacency');

%------------------------------------------%

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 1. Y01_01B16459B\CoreA\'
getMinimumDistancesFromHexagonalGrid

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 1. Y01_01B16459B\CoreB\'
getMinimumDistancesFromHexagonalGrid

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 2. Y02A_02B03119A\CoreA\'
getMinimumDistancesFromHexagonalGrid

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 2. Y02A_02B03119A\CoreB\'
getMinimumDistancesFromHexagonalGrid

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 3. Y02A_02B13320A\CoreA\'
getMinimumDistancesFromHexagonalGrid

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 4. Y03A_03B12888B\CoreB\'
getMinimumDistancesFromHexagonalGrid

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 5. Y03A_03B17300B\CoreA\'
getMinimumDistancesFromHexagonalGrid

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 5. Y03A_03B17300B\CoreB\'
getMinimumDistancesFromHexagonalGrid

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 6. Y03B_03B03346B\CoreB\'
getMinimumDistancesFromHexagonalGrid

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 7. Y03B_03B07423A\CoreA\'
getMinimumDistancesFromHexagonalGrid

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 7. Y03B_03B07423A\CoreB\'
getMinimumDistancesFromHexagonalGrid

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 8. Y03B_03B08572A\CoreA\'
getMinimumDistancesFromHexagonalGrid

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 8. Y03B_03B08572A\CoreB\'
getMinimumDistancesFromHexagonalGrid

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 9. Y2_333688B\CoreB\'
getMinimumDistancesFromHexagonalGrid

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 10. Y2_99B00646B\CoreB\'
getMinimumDistancesFromHexagonalGrid

cd 'E:\Pablo\Neuroblastoma\Datos\Data\Casos\CASO 11. Y2_99B13169A\CoreA\'
getMinimumDistancesFromHexagonalGrid

%----------------------------- NUEVOS CASOS -----------------------------%

cd 'E:\Pablo\Neuroblastoma\Datos\Data\NuevosCasos160\Casos\Images\'
getMinimumDistancesFromHexagonalGrid

cd 'E:\Pablo\Neuroblastoma\Datos\Data\NuevosCasos160\Casos\Networks\IterationAlgorithm\'
calculateLEDAFilesFromDirectory

cd 'E:\Pablo\Neuroblastoma\Datos\Data\NuevosCasos160\Casos\Networks\SortingAlgorithm\'
calculateLEDAFilesFromDirectory


distanceMatrix = dlmread('E:\Pablo\Neuroblastoma\Results\graphletsCount\NuevosCasos\RET\NDUMP2\TotalGraphletsPerAlgorithm\Sorting\gcd11.txt', '\t', 1, 1);
names = importfileNames('E:\Pablo\Neuroblastoma\Results\graphletsCount\NuevosCasos\RET\NDUMP2\TotalGraphletsPerAlgorithm\Sorting\gcd11.txt');
easyHeatmap(distanceMatrix, names, 'totalGraphletsIteration', '', max(distanceMatrix(:)));


load('E:\Pablo\Neuroblastoma\Results\graphletsCount\NuevosCasos\RET\TestControl\matlabGCD73.mat');


easyHeatmap(distanceMatrix, names, 'testingControlsOnlyControls', 'Test');
easyHeatmap(distanceMatrix, names, 'testingControlsOnlyControlsSorting', 'minimumDistanceClassesTest');
easyHeatmap(distanceMatrix, names, 'testingControlsOnlyControlsIteration', 'minimumDistanceClassesBetweenPairsTest');

easyHeatmap(distanceMatrix, names, 'testingControlsIteration', 'minimumDistanceClassesBetweenPairs');
easyHeatmap(distanceMatrix, names, 'testingControlsSorting', 'minimumDistanceClassesBetweenPairs'); %You should change the code, to not show the filter string


analyzeGraphletsDistances('E:\Pablo\Neuroblastoma\Results\graphletsCount\NuevosCasos\RET\NDUMP2\DivideByPacient\AgainstControl\', 'ret', 'gdda');
analyzeGraphletsDistances('E:\Pablo\Neuroblastoma\Results\graphletsCount\NuevosCasos\RET\NDUMP2\DivideByPacient\AgainstHexagons\', 'ret', 'gdda');

%% Pipeline
params = {{'ret', 'CD31', 'VTN', 'COL', 'GAGs', 'CD240'}, {'RET', 'VasosSanguineos', 'Vitronectine', 'COLAGENO', 'GAGs', 'LymphaticVessels'}};

parfor i = 1:size(params{1}, 2)
    pipelineAnalyzeNetworksWithGraphlets(params{1}{i}, params{2}{i});
end

pipelineAnalyzeNetworksWithGraphlets( 'VTN', 'Vitronectine');
pipelineAnalyzeNetworksWithGraphlets( 'ret', 'RET' );
%pipelineAnalyzeNetworksWithGraphlets( 'CD163', 'CD163');
pipelineAnalyzeNetworksWithGraphlets( 'COL', 'COLAGENO');
pipelineAnalyzeNetworksWithGraphlets( 'GAGs', 'GAGs');
pipelineAnalyzeNetworksWithGraphlets( 'CD31', 'VasosSanguineos');
pipelineAnalyzeNetworksWithGraphlets( 'CD240', 'LymphaticVessels');


analyzeGraphletsDistances('..\Results\graphletsCount\NuevosCasos\GraphletsMarkers\RET\NDUMP2\DivideByPacient\AgainstNewControl\', 'ret', 'gdda');
analyzeGraphletsDistances('..\Results\graphletsCount\NuevosCasos\GraphletsMarkers\VasosSanguineos\NDUMP2\DivideByPacient\AgainstNewControl\', 'CD31', 'gdda');
analyzeGraphletsDistances('..\Results\graphletsCount\NuevosCasos\GraphletsMarkers\VTN\NDUMP2\DivideByPacient\AgainstNewControl\', 'MACR', 'gdda');
analyzeGraphletsDistances('..\Results\graphletsCount\NuevosCasos\GraphletsMarkers\VTN\NDUMP2\DivideByPacient\AgainstNewControl\', 'HEPA', 'gdda');
analyzeGraphletsDistances('..\Results\graphletsCount\NuevosCasos\GraphletsMarkers\COL\NDUMP2\DivideByPacient\AgainstNewControl\', 'COL', 'gdda');
analyzeGraphletsDistances('..\Results\graphletsCount\NuevosCasos\GraphletsMarkers\GAGs\NDUMP2\DivideByPacient\AgainstNewControl\', 'GAGs', 'gdda');
analyzeGraphletsDistances('..\Results\graphletsCount\NuevosCasos\GraphletsMarkers\LymphaticVessels\NDUMP2\DivideByPacient\AgainstNewControl', 'CD240', 'gdda');


%Weights

analyzeGraphletsDistances('D:\Pablo\Neuroblastoma\Results\graphletsCount\NuevosCasos\GraphletsMarkers\RET\NDUMP2\DivideByPacient\AgainstControlWeights\', 'ret', 'gdda');
%% painting networks
load('D:\Pablo\Neuroblastoma\Datos\Data\NuevosCasos160\Casos\Vitronectine\Networks\MinimumSpanningTree\mst__04B00051B_Y04B_VTN_MACR_maskContigousHexagonalMeanAreaMask50Diamet.mat')
imageName = 'D:\Pablo\Neuroblastoma\Datos\Data\NuevosCasos160\Casos\Vitronectine\Images\Y04B\_04B00051A\_04B00051B_Y04B_VTN_MACR_mask.tif';
load('D:\Pablo\Neuroblastoma\Datos\Data\NuevosCasos160\Casos\Vitronectine\Networks\DistanceMatrixWeights\_04B00051B_Y04B_VTN_MACR_maskContigousHexagonalMeanAreaMask50DiametDistanceMatrix.mat');
paintNetworkIntoARealImage(imageName, adjacencyMatrix, centroids, '04B00051 MACR', 'MST');


%% Painting networks
sortingDirectory = 'D:\Pablo\Neuroblastoma\Datos\Data\NuevosCasos160\Casos\Vitronectine\Networks\SortingAlgorithm\';
iterationDirectory = 'D:\Pablo\Neuroblastoma\Datos\Data\NuevosCasos160\Casos\Vitronectine\Networks\IterationAlgorithm\';
mstDirectory = 'D:\Pablo\Neuroblastoma\Datos\Data\NuevosCasos160\Casos\Vitronectine\Networks\MinimumSpanningTree\';
imageDirectory = 'D:\Pablo\Neuroblastoma\Datos\Data\NuevosCasos160\Casos\Vitronectine\Images\';
distanceMatrixDirectory = 'D:\Pablo\Neuroblastoma\Datos\Data\NuevosCasos160\Casos\Vitronectine\Networks\DistanceMatrixWeights\';

cases = {'01B21578' %HighRisk
    '06B05411' %NoRisk
    '06B01779' %NoRisk
    '11B17262' %HighRisk
    };

allFiles = {getAllFiles(sortingDirectory); getAllFiles(iterationDirectory); getAllFiles(imageDirectory); getAllFiles(distanceMatrixDirectory); getAllFiles(mstDirectory)};

marker = {'HEPA'};

for numCase = 3:size(cases, 1)
    for numMarker = 1:size(marker, 2)
        close all
        load(allFiles{4}{cellfun(@(x) isempty(strfind(x, marker{numMarker})) == 0 & isempty(strfind(x, cases{numCase})) == 0, allFiles{4})});
        %imageName = allFiles{3}{cellfun(@(x) isempty(strfind(x, cases{numCase})) == 0 & isempty(strfind(lower(x), 'def')) == 0, allFiles{3})};
        imageName = allFiles{3}{cellfun(@(x) isempty(strfind(x, marker{numMarker})) == 0 & isempty(strfind(x, cases{numCase})) == 0 & isempty(strfind(lower(x), 'mask')) == 0, allFiles{3})};
        %MST
        load(allFiles{5}{cellfun(@(x) isempty(strfind(lower(x), 'control')) & isempty(strfind(x, marker{numMarker})) == 0 & isempty(strfind(x, cases{numCase})) == 0, allFiles{5})});
        %paintNetworkIntoARealImage(imageName, adjacencyMatrix, centroids, strcat(cases{numCase}, marker{numMarker}),'mst');
        %painting sorting
        load(allFiles{1}{cellfun(@(x) isempty(strfind(lower(x), 'control')) & isempty(strfind(lower(x), 'final')) == 0 & isempty(strfind(x, marker{numMarker})) == 0 & isempty(strfind(x, cases{numCase})) == 0, allFiles{1})});
        %paintNetworkIntoARealImage(imageName, adjacencyMatrix, centroids, strcat(cases{numCase}, marker{numMarker}), 'sorting');
        %painting iteration
        load(allFiles{2}{cellfun(@(x) isempty(strfind(lower(x), 'control')) & isempty(strfind(lower(x), 'final')) == 0 & isempty(strfind(x, marker{numMarker})) == 0 & isempty(strfind(x, cases{numCase})) == 0, allFiles{2})});
        paintNetworkIntoARealImage(imageName, adjacencyMatrix, centroids, strcat(cases{numCase}, marker{numMarker}),'iteration');
    end
end



%% 3D analysis
analysis3D('D:\Pablo\Neuroblastoma\Datos\Data\NuevosCasos160\Casos', {'COLAGENO', 'VasosSanguineos', 'RET', 'GAGs', 'LymphaticVessels', 'Vitronectine'});


%% Get a region with hexagons
Img = double(x_04B00051B_Y04B_VTN_MACR_mask);
maskName = strcat('..\Mascaras\HexagonalMask', num2str(50), 'Diamet.mat');
mask = importdata(maskName);
mask = mask(1:size(Img, 1), 1:size(Img,2));

ImgMasked = Img .* mask;

maskRGB(:, :, 1) = double(mask==0) * 102 / 255;
maskRGB(:, :, 2) = double(mask==0) * 153 / 255;
maskRGB(:, :, 3) = double(mask==0) * 1 ;

imgSkel = bwmorph(Img,'skel',inf);
imgBranchingPoints = bwmorph(imgSkel,'branchpoints');

imgBranchingPoints = imgBranchingPoints .* ImgMasked;

imgToOverlap = ImgMasked;
imgBranchingPointsRGB = maskRGB;
imgBranchingPointsRGB(find(imgToOverlap > 0)) = imgToOverlap(imgToOverlap > 0);
imgBranchingPointsRGB(find(imgToOverlap > 0) + (size(ImgMasked, 1) * size(ImgMasked, 2))) = imgToOverlap(imgToOverlap > 0);
imgBranchingPointsRGB(find(imgToOverlap > 0) + (size(ImgMasked, 1) * size(ImgMasked, 2))*2) = imgToOverlap(imgToOverlap > 0);

boundingBox = [2980.5 3732.5 384 312];
imgCropped = imcrop(imgBranchingPointsRGB, boundingBox);
figure; imshow(imgCropped);


%% Quantifying Intra and pericellular VN
imgFiles = 'D:\Pablo\Neuroblastoma\Datos\Data\NuevosCasos160\Casos\Vitronectine\Images\';
tmas = dir(imgFiles);

casesToStore = {};
meanClosestVN = [];
for numTma = 3:size(tmas, 1)
    actualTma = tmas(numTma);
    allCases = dir(strcat(actualTma.folder, '\', actualTma.name));
    for numCase = 3:size(allCases, 1)
        actualCase = allCases(numCase);
        casesToStore(end+1) = {actualCase.name};
        meanClosestVN(end+1) = quantifyingIntraCellularVN(strcat(actualCase.folder, '\', actualCase.name, '\'));
    end
end
 allResults = table(casesToStore', meanClosestVN');
 
 
%% Mice analysis

params = {{'ret', 'CD31', 'VTN', 'COL', 'GAGs', 'CD240'}, {'RET', 'VasosSanguineos', 'Vitronectine', 'COLAGENO', 'GAGs', 'LymphaticVessels'}};

pipelineAnalyzeNetworksWithGraphlets('VTN', 'VTN', '..\Datos\Data\Mice\round0\');

for i = 1:size(params{1}, 2)
    pipelineAnalyzeNetworksWithGraphlets(params{1}{i}, params{2}{i}, '..\Datos\Data\Mice\');
end
